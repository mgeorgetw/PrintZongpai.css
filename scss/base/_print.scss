@media print {
  /* Book title */
  header {
    width: 30em;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    -webkit-writing-mode: horizontal-tb;
  }
  header .title { 
    page-break-after: avoid;
    letter-spacing: 0;
  }
  header .title:after {
    content: '';
    display: block;
    position: relative;
    margin-top: 10pt;
    height: 1pt;
    width: 100%;
    background: #555;
  }
  header .author { 
    page-break-before: avoid;
    text-indent: 0;
    display: block;
  }

  /* Table of contents */
  #TOC {
    page-break-before: always;
    page-break-after: always;
  }
  // Page counter style
  #TOC a::after {
    content: target-counter(attr(href), page);
    -webkit-writing-mode: horizontal-tb;
    color: #888;
    padding-top: 1em;
    font-weight: 200;
    font-size: 0.8em;
    align-self:flex-end;
    flex:none;
    order:2;
  }

  /* Chapter title */
  article > h2 {
    page-break-before: left;
    text-indent: 2rem;
  }

  h2, h3 {
    -webkit-column-break-after: avoid;
    page-break-after: avoid;
  }

  /* Paragraph styles */
  p { 
    orphans: 1;
    widows: 1;
    margin: 0;
    text-indent: 2em;
  }
  // // Un-indent first paragraph
  // p:first-of-type {
  //   text-indent: 0;
  // }
  a {
    text-decoration: none;
    color: inherit;
  }
  // // Writes out explicit link URLs 
  // article a[href^=http]:after {
  //   content:"〈" attr(href) "〉";
  //   color: #777;
  // }
  // article a[href^="#"]:after {
  //   content: "";
  // }
  
  figure {
    // (float: snap-block + float-reference:page) allow text to wrap around images, but somehow this messes up TOC and some images won't show. Could be a rendering bug
    // float: snap-block;
    // float-reference: page;
    // height: 100%; // Allows text to flow over image (a temporary solution)
    // clear: all;
    margin: 2em -1em; // Larger image aligns with indented text 
    page-break-inside: avoid;
  }
  figure img {
    // filter: contrast(1.2) grayscale(1); // This makes images blurry
    image-resolution: 300dpi;
  }

  /* Temporary inline footnote, footnote refs doesn't work with Vivliostyle */
  span.footnote {
    font-family: $fangsong-font-family;
    float: footnote;
    counter-increment: footnote;
    margin-top: 1.2em;
    text-indent: -1.6em;
    footnote-policy:line;
  }

  span.footnote::footnote-marker,
  span.footnote::footnote-call {
    content: '['counter(footnote)']';
    font-size: 0.8em;
    text-indent: 0;
    vertical-align: 10%;
    font-family: "Helvetica Neue";
    -webkit-writing-mode: horizontal-tb;
    -epub-writing-mode: horizontal-tb;
  }

  span.footnote::footnote-call {
    margin-top: -0.3em;
    font-size: 0.6em;
  }

  /* Reference footnotes generated by Pandoc */
  .footnoteRef sup,
  .footnote-ref sup {
    text-indent: 0;
  }
  .footnotes p {
    text-indent: 0;
    page-break-inside: avoid;
  }
  .footnotes li:before {
    page-break-after: avoid;
  }
  // Hides "return" symbol on printed pages
  .footnotes a:last-child {
    display: none;
  }

  #bttBtn { display: none; }
}